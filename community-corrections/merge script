// merge-corrections.js - Run this in Node.js to merge contributions
const fs = require('fs');

const master = JSON.parse(fs.readFileSync('community-corrections/master.json'));
const contribution = JSON.parse(fs.readFileSync('path/to/contribution.json'));

// Merge corrections
Object.keys(contribution.corrections).forEach(key => {
    if (!master.corrections[key]) {
        master.corrections[key] = contribution.corrections[key];
    } else {
        contribution.corrections[key].corrections.forEach(corr => {
            const existing = master.corrections[key].corrections.find(c => c.to.id === corr.to.id);
            if (existing) {
                existing.count += corr.count;
            } else {
                master.corrections[key].corrections.push(corr);
            }
        });
    }
});

// Update stats
master.lastUpdated = new Date().toISOString();
master.stats.totalSymbols = Object.keys(master.corrections).length;
master.stats.totalCorrections = Object.values(master.corrections)
    .reduce((sum, c) => sum + c.corrections.reduce((s, cor) => s + cor.count, 0), 0);

fs.writeFileSync('community-corrections/master.json', JSON.stringify(master, null, 2));
console.log('âœ… Merged successfully!');